# XSS

Cross-Site Scripting（跨站脚本攻击）简称 XSS，是一种代码注入攻击。攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全。

Cross-site scripting的英文首字母缩写本应为 CSS，但因为 CSS 在网页设计领域已经被广泛指层叠样式表（Cascading Style Sheets），所以将Cross（意为“交叉”）改以交叉形的X做为缩写。但早期的文件还是会使用 CSS 表示 Cross-site scripting。

默认网站只能运行我们自己站内的代码。

XSS 攻击能够实现把外部 JavaScript 注入网站内部，形成攻击。
XSS 的本质是：恶意代码未经过滤，与网站正常的代码混在一起；浏览器无法分辨哪些脚本是可信的，导致恶意脚本被执行。

而由于直接在用户的终端执行，恶意代码能够直接获取用户的信息，或者利用这些信息冒充用户向网站发起攻击者定义的请求。
在部分情况下，由于输入的限制，注入的恶意脚本比较短。但可以通过引入外部的脚本，并由浏览器执行，来完成比较复杂的攻击策略。

## XSS攻击原理
```js
  data: {
    content: '<img src="xxx" onerror="alert(123)">'
  }

  <div v-html="content"></div>
```

## XSS 的危害
+ 窃取 Cookie
+ 按键记录和钓鱼
+ 未授权操作
+ 获取页面数据
+ 获取 Cookies
+ 获取本地存储数据
+ 劫持前端逻辑
+ 发送请求
+ 图片、表单等
+ 偷取网站任意数据
+ 偷取用户资料
+ 偷取用户密码和登录状态
+ 欺骗用户
+ 利用虚假输入表单骗取用户个人信息
+ 利用脚本窃取用户的 Cookie，被害者在不知情的情况下，帮助攻击者发送恶意请求
+ 显示伪造的文章或图片
+ ...

## XSS 攻击分类

+ 反射型 XSS：url
+ 存储型 XSS：数据持久化
+ DOM XSS：纯前端 DOM 操作

反射型和存储型在纯前端渲染中已经很少见了，尤其是在大量使用第三方框架的前提下。

+ Vue
+ React
+ Angular
+ ....

### 反射性 XSS
反射型 XSS 的攻击步骤：
+ 攻击者构造出特殊的 URL，其中包含恶意代码。
+ 用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。
+ 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
+ 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。
```js
  <h1 class="logo-font" v-html="$route.query.content"></h1>
```
请求地址：
```js
  http://localhost:8080/#/?content=<img src="xxx" onerror="alert(123)">
```